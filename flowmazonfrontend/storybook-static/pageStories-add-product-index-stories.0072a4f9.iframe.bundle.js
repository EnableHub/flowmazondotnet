(self.webpackChunkflowmazonfrontend=self.webpackChunkflowmazonfrontend||[]).push([[158],{"./src/pageStories/add-product/index.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{ErrorCases:()=>ErrorCases,__namedExportsOrder:()=>__namedExportsOrder,default:()=>index_stories});var chunk_LSEVNFON=__webpack_require__("../node_modules/@faker-js/faker/dist/chunk-LSEVNFON.js"),jsx_runtime=__webpack_require__("./node_modules/next/dist/compiled/react/jsx-runtime.js"),head=__webpack_require__("./node_modules/next/head.js"),head_default=__webpack_require__.n(head),index_esm=__webpack_require__("./node_modules/yup/index.esm.js"),clsx=__webpack_require__("./node_modules/clsx/dist/clsx.mjs"),formik_esm=__webpack_require__("./node_modules/formik/dist/formik.esm.js"),react=__webpack_require__("./node_modules/next/dist/compiled/react/index.js"),console=__webpack_require__("./node_modules/console-browserify/index.js");function cov_gcfegq4hp(){var path="C:\\MyWork\\flowmazondotnet\\flowmazonfrontend\\src\\utils\\useFormikAccessible.ts",global=new Function("return this")(),gcv="__coverage__",coverage=global[gcv]||(global[gcv]={});coverage[path]&&"cbd2fe82beb2df002cb3a380216e354e6e1bac76"===coverage[path].hash||(coverage[path]={path:"C:\\MyWork\\flowmazondotnet\\flowmazonfrontend\\src\\utils\\useFormikAccessible.ts",statementMap:{0:{start:{line:10,column:19},end:{line:10,column:36}},1:{start:{line:13,column:21},end:{line:13,column:54}},2:{start:{line:14,column:8},end:{line:17,column:16}},3:{start:{line:14,column:50},end:{line:17,column:13}},4:{start:{line:19,column:46},end:{line:19,column:99}},5:{start:{line:20,column:25},end:{line:27,column:5}},6:{start:{line:21,column:8},end:{line:21,column:46}},7:{start:{line:22,column:8},end:{line:22,column:31}},8:{start:{line:23,column:8},end:{line:26,column:11}},9:{start:{line:28,column:68},end:{line:28,column:121}},10:{start:{line:29,column:23},end:{line:38,column:5}},11:{start:{line:30,column:8},end:{line:30,column:44}},12:{start:{line:31,column:8},end:{line:31,column:29}},13:{start:{line:32,column:8},end:{line:37,column:11}},14:{start:{line:39,column:25},end:{line:43,column:5}},15:{start:{line:40,column:8},end:{line:40,column:46}},16:{start:{line:41,column:8},end:{line:41,column:31}},17:{start:{line:42,column:8},end:{line:42,column:80}},18:{start:{line:44,column:36},end:{line:44,column:69}},19:{start:{line:45,column:21},end:{line:45,column:64}},20:{start:{line:46,column:4},end:{line:48,column:7}},21:{start:{line:47,column:8},end:{line:47,column:102}},22:{start:{line:49,column:4},end:{line:55,column:6}}},fnMap:{0:{name:"useFormikAccessible",decl:{start:{line:9,column:24},end:{line:9,column:43}},loc:{start:{line:9,column:52},end:{line:56,column:1}},line:9},1:{name:"sameValueAgainstEachValidatedControl",decl:{start:{line:11,column:13},end:{line:11,column:49}},loc:{start:{line:11,column:57},end:{line:18,column:5}},line:11},2:{name:"(anonymous_2)",decl:{start:{line:14,column:43},end:{line:14,column:44}},loc:{start:{line:14,column:50},end:{line:17,column:13}},line:14},3:{name:"(anonymous_3)",decl:{start:{line:20,column:25},end:{line:20,column:26}},loc:{start:{line:20,column:30},end:{line:27,column:5}},line:20},4:{name:"(anonymous_4)",decl:{start:{line:29,column:23},end:{line:29,column:24}},loc:{start:{line:29,column:28},end:{line:38,column:5}},line:29},5:{name:"(anonymous_5)",decl:{start:{line:39,column:25},end:{line:39,column:26}},loc:{start:{line:39,column:30},end:{line:43,column:5}},line:39},6:{name:"(anonymous_6)",decl:{start:{line:46,column:36},end:{line:46,column:37}},loc:{start:{line:46,column:51},end:{line:48,column:5}},line:46}},branchMap:{0:{loc:{start:{line:34,column:44},end:{line:36,column:58}},type:"binary-expr",locations:[{start:{line:34,column:44},end:{line:34,column:79}},{start:{line:36,column:12},end:{line:36,column:58}}],line:34},1:{loc:{start:{line:47,column:32},end:{line:47,column:101}},type:"binary-expr",locations:[{start:{line:47,column:32},end:{line:47,column:69}},{start:{line:47,column:73},end:{line:47,column:101}}],line:47}},s:{0:0,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:0,11:0,12:0,13:0,14:0,15:0,16:0,17:0,18:0,19:0,20:0,21:0,22:0},f:{0:0,1:0,2:0,3:0,4:0,5:0,6:0},b:{0:[0,0],1:[0,0]},inputSourceMap:{version:3,sources:["C:\\MyWork\\flowmazondotnet\\flowmazonfrontend\\src\\utils\\useFormikAccessible.ts"],sourcesContent:["/* eslint-disable @typescript-eslint/no-unused-vars */\nimport { useFormik, FormikConfig, FormikValues, FormikProps } from 'formik';\n\nimport { FormEvent, useEffect, useState } from 'react';\nimport * as Yup from 'yup';\n\n//TODO: Document the hook: it is just  as a decorator for the specific\n//behaviour of computing an error on a field based on whether it has\n//been changed and subsequently exited or if there was an\n//in the field when we last tried to submit (whether or not\n//we had exited or changed the field). These computed errors\n//would be made available as an additional \"hasError\" property.\n\nexport default function useFormikAccessible<Values extends FormikValues>(\n  config: FormikConfig<Values>,\n): FormikProps<Values> & {\n  hasError: { [InputControl in keyof Values]: boolean };\n} {\n  const formik = useFormik(config);\n\n  function sameValueAgainstEachValidatedControl<T>(value: T): {\n    [InputName in keyof typeof formik.initialValues]: T;\n  } {\n    // //HAIRY FUNCTION...KEEP A TAB ON TYPE ASSERTIONS\n\n    const keys: (keyof typeof formik.initialValues)[] = Object.keys(\n      formik.initialValues,\n    );\n    return Object.fromEntries(keys.map((key) => [key, value])) as {\n      [InputName in keyof typeof formik.initialValues]: T;\n    };\n  }\n\n  const [inputsChanged, setInputsChanged] = useState(\n    sameValueAgainstEachValidatedControl(false),\n  );\n\n  const handleChange = (\n    e: FormEvent<HTMLInputElement | HTMLTextAreaElement>,\n  ) => {\n    console.log('CHANGE handler called.');\n    formik.handleChange(e);\n    setInputsChanged({\n      ...inputsChanged,\n      [e.currentTarget.name]: true, //cheating a bit as this\n      //falls outside TS type checking\n    });\n  };\n\n  const [inputsChangedThenBlurred, setInputsChangedThenBlurred] = useState(\n    sameValueAgainstEachValidatedControl(false),\n  );\n\n  const handleBlur = (e: FormEvent<HTMLInputElement | HTMLTextAreaElement>) => {\n    console.log('BLUR handler called.');\n    formik.handleBlur(e);\n    setInputsChangedThenBlurred({\n      ...inputsChangedThenBlurred,\n      [e.currentTarget.name]:\n        /* ( */ inputsChanged[\n          e.currentTarget.name\n        ] /*&& we know it has just blurred)*/ ||\n        //Following allows us to take into account value set\n        //if user tried to submit form before\n        inputsChangedThenBlurred[e.currentTarget.name],\n    });\n  };\n\n  const handleSubmit = (e?: FormEvent<HTMLFormElement>) => {\n    console.log('SUBMIT handler called.');\n    formik.handleSubmit(e);\n\n    setInputsChangedThenBlurred(sameValueAgainstEachValidatedControl(true));\n  };\n\n  const namesOfValidatedControl: (keyof typeof formik.initialValues)[] =\n    Object.keys(formik.initialValues);\n  const hasError = sameValueAgainstEachValidatedControl(false);\n  namesOfValidatedControl.forEach((controlName) => {\n    hasError[controlName] =\n      inputsChangedThenBlurred[controlName] && !!formik.errors[controlName];\n  });\n\n  return {\n    ...formik,\n    handleSubmit,\n    handleChange,\n    handleBlur,\n    hasError,\n  };\n}\n"],names:["useFormik","useState","useFormikAccessible","config","formik","sameValueAgainstEachValidatedControl","value","keys","Object","initialValues","fromEntries","map","key","inputsChanged","setInputsChanged","handleChange","e","console","log","currentTarget","name","inputsChangedThenBlurred","setInputsChangedThenBlurred","handleBlur","handleSubmit","namesOfValidatedControl","hasError","forEach","controlName","errors"],mappings:"AAAA,oDAAoD,GACpD,SAASA,SAAS,QAAiD,SAAS;AAE5E,SAA+BC,QAAQ,QAAQ,QAAQ;AAGvD,sEAAsE;AACtE,oEAAoE;AACpE,yDAAyD;AACzD,2DAA2D;AAC3D,4DAA4D;AAC5D,+DAA+D;AAE/D,eAAe,SAASC,oBACtBC,MAA4B;IAI5B,MAAMC,SAASJ,UAAUG;IAEzB,SAASE,qCAAwCC,KAAQ;QAGvD,mDAAmD;QAEnD,MAAMC,OAA8CC,OAAOD,IAAI,CAC7DH,OAAOK,aAAa;QAEtB,OAAOD,OAAOE,WAAW,CAACH,KAAKI,GAAG,CAAC,CAACC,MAAQ;gBAACA;gBAAKN;aAAM;IAG1D;IAEA,MAAM,CAACO,eAAeC,iBAAiB,GAAGb,SACxCI,qCAAqC;IAGvC,MAAMU,eAAe,CACnBC;QAEAC,QAAQC,GAAG,CAAC;QACZd,OAAOW,YAAY,CAACC;QACpBF,iBAAiB;YACf,GAAGD,aAAa;YAChB,CAACG,EAAEG,aAAa,CAACC,IAAI,CAAC,EAAE;QAE1B;IACF;IAEA,MAAM,CAACC,0BAA0BC,4BAA4B,GAAGrB,SAC9DI,qCAAqC;IAGvC,MAAMkB,aAAa,CAACP;QAClBC,QAAQC,GAAG,CAAC;QACZd,OAAOmB,UAAU,CAACP;QAClBM,4BAA4B;YAC1B,GAAGD,wBAAwB;YAC3B,CAACL,EAAEG,aAAa,CAACC,IAAI,CAAC,EACpB,KAAK,GAAGP,aAAa,CACnBG,EAAEG,aAAa,CAACC,IAAI,CACrB,IACD,oDAAoD;YACpD,qCAAqC;YACrCC,wBAAwB,CAACL,EAAEG,aAAa,CAACC,IAAI,CAAC;QAClD;IACF;IAEA,MAAMI,eAAe,CAACR;QACpBC,QAAQC,GAAG,CAAC;QACZd,OAAOoB,YAAY,CAACR;QAEpBM,4BAA4BjB,qCAAqC;IACnE;IAEA,MAAMoB,0BACJjB,OAAOD,IAAI,CAACH,OAAOK,aAAa;IAClC,MAAMiB,WAAWrB,qCAAqC;IACtDoB,wBAAwBE,OAAO,CAAC,CAACC;QAC/BF,QAAQ,CAACE,YAAY,GACnBP,wBAAwB,CAACO,YAAY,IAAI,CAAC,CAACxB,OAAOyB,MAAM,CAACD,YAAY;IACzE;IAEA,OAAO;QACL,GAAGxB,MAAM;QACToB;QACAT;QACAQ;QACAG;IACF;AACF"},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"cbd2fe82beb2df002cb3a380216e354e6e1bac76"});var actualCoverage=coverage[path];return cov_gcfegq4hp=function(){return actualCoverage},actualCoverage}function cov_1oxsw1627c(){var path="C:\\MyWork\\flowmazondotnet\\flowmazonfrontend\\src\\utils\\config.ts",global=new Function("return this")(),gcv="__coverage__",coverage=global[gcv]||(global[gcv]={});coverage[path]&&"158bdda4033bc8b4fd10d6e9afcef468b980a704"===coverage[path].hash||(coverage[path]={path:"C:\\MyWork\\flowmazondotnet\\flowmazonfrontend\\src\\utils\\config.ts",statementMap:{0:{start:{line:1,column:16},end:{line:1,column:56}},1:{start:{line:2,column:22},end:{line:7,column:1}}},fnMap:{},branchMap:{},s:{0:0,1:0},f:{},b:{},inputSourceMap:{version:3,sources:["C:\\MyWork\\flowmazondotnet\\flowmazonfrontend\\src\\utils\\config.ts"],sourcesContent:["const baseUrl = `${process.env.NEXT_PUBLIC_BACKEND_URL}`;\n\nexport const config = {\n  serviceUrls: {\n    base: `${baseUrl}`,\n    product: `${baseUrl}/product`,\n  },\n};\n"],names:["baseUrl","process","env","NEXT_PUBLIC_BACKEND_URL","config","serviceUrls","base","product"],mappings:"AAAA,MAAMA,UAAU,CAAC,EAAEC,QAAQC,GAAG,CAACC,uBAAuB,CAAC,CAAC;AAExD,OAAO,MAAMC,SAAS;IACpBC,aAAa;QACXC,MAAM,CAAC,EAAEN,QAAQ,CAAC;QAClBO,SAAS,CAAC,EAAEP,QAAQ,QAAQ,CAAC;IAC/B;AACF,EAAE"},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"158bdda4033bc8b4fd10d6e9afcef468b980a704"});var actualCoverage=coverage[path];return cov_1oxsw1627c=function(){return actualCoverage},actualCoverage}cov_gcfegq4hp(),cov_1oxsw1627c();const baseUrl=(cov_1oxsw1627c().s[0]++,"http://localhost:5003"),config=(cov_1oxsw1627c().s[1]++,{serviceUrls:{base:`${baseUrl}`,product:`${baseUrl}/product`}});var add_product_console=__webpack_require__("./node_modules/console-browserify/index.js");function cov_gsgi2ujjm(){var path="C:\\MyWork\\flowmazondotnet\\flowmazonfrontend\\src\\pages\\add-product\\index.tsx",global=new Function("return this")(),gcv="__coverage__",coverage=global[gcv]||(global[gcv]={});coverage[path]&&"17720cf5133b91df622ae8822eb5fb9bb5acf241"===coverage[path].hash||(coverage[path]={path:"C:\\MyWork\\flowmazondotnet\\flowmazonfrontend\\src\\pages\\add-product\\index.tsx",statementMap:{0:{start:{line:7,column:32},end:{line:12,column:2}},1:{start:{line:16,column:4},end:{line:16,column:64}},2:{start:{line:17,column:17},end:{line:34,column:6}},3:{start:{line:26,column:29},end:{line:32,column:14}},4:{start:{line:35,column:4},end:{line:169,column:7}},5:{start:{line:171,column:0},end:{line:175,column:2}}},fnMap:{0:{name:"AddProductPage",decl:{start:{line:15,column:24},end:{line:15,column:38}},loc:{start:{line:15,column:41},end:{line:170,column:1}},line:15},1:{name:"(anonymous_1)",decl:{start:{line:25,column:18},end:{line:25,column:19}},loc:{start:{line:25,column:34},end:{line:33,column:9}},line:25}},branchMap:{0:{loc:{start:{line:58,column:48},end:{line:58,column:120}},type:"binary-expr",locations:[{start:{line:58,column:48},end:{line:58,column:66}},{start:{line:58,column:70},end:{line:58,column:120}}],line:58},1:{loc:{start:{line:74,column:50},end:{line:74,column:88}},type:"binary-expr",locations:[{start:{line:74,column:50},end:{line:74,column:68}},{start:{line:74,column:72},end:{line:74,column:88}}],line:74},2:{loc:{start:{line:85,column:48},end:{line:85,column:127}},type:"binary-expr",locations:[{start:{line:85,column:48},end:{line:85,column:73}},{start:{line:85,column:77},end:{line:85,column:127}}],line:85},3:{loc:{start:{line:100,column:50},end:{line:100,column:102}},type:"binary-expr",locations:[{start:{line:100,column:50},end:{line:100,column:75}},{start:{line:100,column:79},end:{line:100,column:102}}],line:100},4:{loc:{start:{line:111,column:48},end:{line:111,column:124}},type:"binary-expr",locations:[{start:{line:111,column:48},end:{line:111,column:70}},{start:{line:111,column:74},end:{line:111,column:124}}],line:111},5:{loc:{start:{line:127,column:50},end:{line:127,column:96}},type:"binary-expr",locations:[{start:{line:127,column:50},end:{line:127,column:72}},{start:{line:127,column:76},end:{line:127,column:96}}],line:127},6:{loc:{start:{line:138,column:48},end:{line:138,column:121}},type:"binary-expr",locations:[{start:{line:138,column:48},end:{line:138,column:67}},{start:{line:138,column:71},end:{line:138,column:121}}],line:138},7:{loc:{start:{line:154,column:50},end:{line:154,column:90}},type:"binary-expr",locations:[{start:{line:154,column:50},end:{line:154,column:69}},{start:{line:154,column:73},end:{line:154,column:90}}],line:154}},s:{0:0,1:0,2:0,3:0,4:0,5:0},f:{0:0,1:0},b:{0:[0,0],1:[0,0],2:[0,0],3:[0,0],4:[0,0],5:[0,0],6:[0,0],7:[0,0]},inputSourceMap:{version:3,sources:["C:/MyWork/flowmazondotnet/flowmazonfrontend/src/pages/add-product/index.tsx"],sourcesContent:["/* eslint-disable @typescript-eslint/no-unused-vars */\nimport Head from 'next/head';\nimport * as Yup from 'yup';\n/* import { useRouter } from 'next/router'; */\nimport clsx from 'clsx';\nimport useFormikAccessible from '@/utils/useFormikAccessible';\nimport { config } from '@/utils/config';\n\nexport const validationSchema = Yup.object({\n  name: Yup.string()\n    .max(50, 'Name must be 50 characters or less')\n    .required('Name is required.'),\n  description: Yup.string().required('Description is required.'),\n  imageUrl: Yup.string()\n    .url('Image URL must be a valid URL.')\n    .required('Image URL is required.'),\n  price: Yup.number()\n    .required('Price is required.')\n    .min(0, 'Price must be zero or greater.')\n    .integer('Price must be an integer.'),\n});\n\n//TODO: Factor out repeated blocks of label, control, error message\n//into components\nexport default function AddProductPage() {\n  console.log(validationSchema.describe().fields.description);\n\n  const form = useFormikAccessible({\n    initialValues: {\n      name: '',\n      description: '',\n      imageUrl: '',\n      price: '',\n    },\n    validationSchema: validationSchema,\n    onSubmit: async (values) => {\n      const response = await fetch(config.serviceUrls.product, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify(values),\n      });\n    },\n  });\n\n  return (\n    <>\n      <Head>\n        <title>Add Product - Flowmazon</title>\n      </Head>\n      <div>\n        <h1 className='mb-4 text-lg font-bold'>Add Product</h1>\n        <form action='' onSubmit={form.handleSubmit}>\n          <label htmlFor='name'>Name</label>\n\n          <input\n            type='text'\n            className={clsx(\n              form.hasError.name &&\n                'border-error focus:border-error focus:ring-error',\n\n              'input input-bordered mb-0 w-full focus:outline-none focus:ring-1',\n            )}\n            name='name'\n            value={form.values.name}\n            aria-required='true'\n            onChange={form.handleChange}\n            onBlur={form.handleBlur}\n            aria-invalid={form.hasError.name}\n            aria-describedby='nameError'\n          />\n          <div className='mb-2 mt-0'>\n            <span\n              id='nameError'\n              aria-live='assertive'\n              className='text-sm text-red-500'\n            >\n              {form.hasError.name && form.errors.name}\n            </span>\n            &nbsp;\n          </div>\n          <label htmlFor='description'>Description</label>\n          <textarea\n            name='description'\n            className={clsx(\n              form.hasError.description &&\n                'border-error focus:border-error focus:ring-error',\n\n              'textarea textarea-bordered mb-0 w-full focus:outline-none focus:ring-1',\n            )}\n            value={form.values.description}\n            aria-required='true'\n            onChange={form.handleChange}\n            onBlur={form.handleBlur}\n            aria-invalid={form.hasError.description}\n            aria-describedby='descriptionError'\n          />\n          <div className='mb-2 mt-0'>\n            <span\n              id='descriptionError'\n              aria-live='assertive'\n              className='text-sm text-red-500'\n            >\n              {form.hasError.description && form.errors.description}\n            </span>\n            &nbsp;\n          </div>\n          <label htmlFor='imageUrl'>Image URL</label>\n          <input\n            type='text'\n            className={clsx(\n              form.hasError.imageUrl &&\n                'border-error focus:border-error focus:ring-error',\n\n              'input input-bordered mb-0 w-full focus:outline-none focus:ring-1',\n            )}\n            name='imageUrl'\n            value={form.values.imageUrl}\n            aria-required='true'\n            onChange={form.handleChange}\n            onBlur={form.handleBlur}\n            aria-invalid={form.hasError.imageUrl}\n            aria-describedby='imageUrlError'\n          />\n          <div className='mb-2 mt-0'>\n            <span\n              id='imageUrlError'\n              aria-live='assertive'\n              className='text-sm text-red-500'\n            >\n              {form.hasError.imageUrl && form.errors.imageUrl}\n            </span>\n            &nbsp;\n          </div>\n          <label htmlFor='price'>Price</label>\n          <input\n            type='text'\n            className={clsx(\n              form.hasError.price &&\n                'border-error focus:border-error focus:ring-error',\n\n              'input input-bordered mb-0 w-full focus:outline-none focus:ring-1',\n            )}\n            name='price'\n            value={form.values.price}\n            aria-required='true'\n            onChange={form.handleChange}\n            onBlur={form.handleBlur}\n            aria-invalid={form.hasError.price}\n            aria-describedby='priceError'\n          />\n          <div className='mb-2 mt-0'>\n            <span\n              id='priceError'\n              aria-live='assertive'\n              className='text-sm text-red-500'\n            >\n              {form.hasError.price && form.errors.price}\n            </span>\n            &nbsp;\n          </div>\n          <button type='submit' className='btn btn-primary btn-block mt-4'>\n            Add Product\n          </button>\n        </form>\n      </div>\n    </>\n  );\n}\n"],names:["Head","Yup","clsx","useFormikAccessible","config","validationSchema","object","name","string","max","required","description","imageUrl","url","price","number","min","integer","AddProductPage","console","log","describe","fields","form","initialValues","onSubmit","values","response","fetch","serviceUrls","product","method","headers","body","JSON","stringify","title","div","h1","className","action","handleSubmit","label","htmlFor","input","type","hasError","value","aria-required","onChange","handleChange","onBlur","handleBlur","aria-invalid","aria-describedby","span","id","aria-live","errors","textarea","button"],mappings:"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"},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"17720cf5133b91df622ae8822eb5fb9bb5acf241"});var actualCoverage=coverage[path];return cov_gsgi2ujjm=function(){return actualCoverage},actualCoverage}cov_gsgi2ujjm();const validationSchema=(cov_gsgi2ujjm().s[0]++,index_esm.Ry({name:index_esm.Z_().max(50,"Name must be 50 characters or less").required("Name is required."),description:index_esm.Z_().required("Description is required."),imageUrl:index_esm.Z_().url("Image URL must be a valid URL.").required("Image URL is required."),price:index_esm.Rx().required("Price is required.").min(0,"Price must be zero or greater.").integer("Price must be an integer.")}));function AddProductPage(){cov_gsgi2ujjm().f[0]++,cov_gsgi2ujjm().s[1]++,add_product_console.log(validationSchema.describe().fields.description);const form=(cov_gsgi2ujjm().s[2]++,function useFormikAccessible(config){cov_gcfegq4hp().f[0]++;const formik=(cov_gcfegq4hp().s[0]++,(0,formik_esm.TA)(config));function sameValueAgainstEachValidatedControl(value){cov_gcfegq4hp().f[1]++;const keys=(cov_gcfegq4hp().s[1]++,Object.keys(formik.initialValues));return cov_gcfegq4hp().s[2]++,Object.fromEntries(keys.map((key=>(cov_gcfegq4hp().f[2]++,cov_gcfegq4hp().s[3]++,[key,value]))))}const[inputsChanged,setInputsChanged]=(cov_gcfegq4hp().s[4]++,(0,react.useState)(sameValueAgainstEachValidatedControl(!1)));cov_gcfegq4hp().s[5]++;const[inputsChangedThenBlurred,setInputsChangedThenBlurred]=(cov_gcfegq4hp().s[9]++,(0,react.useState)(sameValueAgainstEachValidatedControl(!1)));cov_gcfegq4hp().s[10]++,cov_gcfegq4hp().s[14]++;const namesOfValidatedControl=(cov_gcfegq4hp().s[18]++,Object.keys(formik.initialValues)),hasError=(cov_gcfegq4hp().s[19]++,sameValueAgainstEachValidatedControl(!1));return cov_gcfegq4hp().s[20]++,namesOfValidatedControl.forEach((controlName=>{cov_gcfegq4hp().f[6]++,cov_gcfegq4hp().s[21]++,hasError[controlName]=(cov_gcfegq4hp().b[1][0]++,inputsChangedThenBlurred[controlName]&&(cov_gcfegq4hp().b[1][1]++,!!formik.errors[controlName]))})),cov_gcfegq4hp().s[22]++,{...formik,handleSubmit:e=>{cov_gcfegq4hp().f[5]++,cov_gcfegq4hp().s[15]++,console.log("SUBMIT handler called."),cov_gcfegq4hp().s[16]++,formik.handleSubmit(e),cov_gcfegq4hp().s[17]++,setInputsChangedThenBlurred(sameValueAgainstEachValidatedControl(!0))},handleChange:e=>{cov_gcfegq4hp().f[3]++,cov_gcfegq4hp().s[6]++,console.log("CHANGE handler called."),cov_gcfegq4hp().s[7]++,formik.handleChange(e),cov_gcfegq4hp().s[8]++,setInputsChanged({...inputsChanged,[e.currentTarget.name]:!0})},handleBlur:e=>{cov_gcfegq4hp().f[4]++,cov_gcfegq4hp().s[11]++,console.log("BLUR handler called."),cov_gcfegq4hp().s[12]++,formik.handleBlur(e),cov_gcfegq4hp().s[13]++,setInputsChangedThenBlurred({...inputsChangedThenBlurred,[e.currentTarget.name]:(cov_gcfegq4hp().b[0][0]++,inputsChanged[e.currentTarget.name]||(cov_gcfegq4hp().b[0][1]++,inputsChangedThenBlurred[e.currentTarget.name]))})},hasError}}({initialValues:{name:"",description:"",imageUrl:"",price:""},validationSchema,onSubmit:async values=>{cov_gsgi2ujjm().f[1]++;cov_gsgi2ujjm().s[3]++,await fetch(config.serviceUrls.product,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(values)})}}));return cov_gsgi2ujjm().s[4]++,(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(head_default(),{children:(0,jsx_runtime.jsx)("title",{children:"Add Product - Flowmazon"})}),(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("h1",{className:"mb-4 text-lg font-bold",children:"Add Product"}),(0,jsx_runtime.jsxs)("form",{action:"",onSubmit:form.handleSubmit,children:[(0,jsx_runtime.jsx)("label",{htmlFor:"name",children:"Name"}),(0,jsx_runtime.jsx)("input",{type:"text",className:(0,clsx.Z)((cov_gsgi2ujjm().b[0][0]++,form.hasError.name&&(cov_gsgi2ujjm().b[0][1]++,"border-error focus:border-error focus:ring-error")),"input input-bordered mb-0 w-full focus:outline-none focus:ring-1"),name:"name",value:form.values.name,"aria-required":"true",onChange:form.handleChange,onBlur:form.handleBlur,"aria-invalid":form.hasError.name,"aria-describedby":"nameError"}),(0,jsx_runtime.jsxs)("div",{className:"mb-2 mt-0",children:[(0,jsx_runtime.jsx)("span",{id:"nameError","aria-live":"assertive",className:"text-sm text-red-500",children:(cov_gsgi2ujjm().b[1][0]++,form.hasError.name&&(cov_gsgi2ujjm().b[1][1]++,form.errors.name))})," "]}),(0,jsx_runtime.jsx)("label",{htmlFor:"description",children:"Description"}),(0,jsx_runtime.jsx)("textarea",{name:"description",className:(0,clsx.Z)((cov_gsgi2ujjm().b[2][0]++,form.hasError.description&&(cov_gsgi2ujjm().b[2][1]++,"border-error focus:border-error focus:ring-error")),"textarea textarea-bordered mb-0 w-full focus:outline-none focus:ring-1"),value:form.values.description,"aria-required":"true",onChange:form.handleChange,onBlur:form.handleBlur,"aria-invalid":form.hasError.description,"aria-describedby":"descriptionError"}),(0,jsx_runtime.jsxs)("div",{className:"mb-2 mt-0",children:[(0,jsx_runtime.jsx)("span",{id:"descriptionError","aria-live":"assertive",className:"text-sm text-red-500",children:(cov_gsgi2ujjm().b[3][0]++,form.hasError.description&&(cov_gsgi2ujjm().b[3][1]++,form.errors.description))})," "]}),(0,jsx_runtime.jsx)("label",{htmlFor:"imageUrl",children:"Image URL"}),(0,jsx_runtime.jsx)("input",{type:"text",className:(0,clsx.Z)((cov_gsgi2ujjm().b[4][0]++,form.hasError.imageUrl&&(cov_gsgi2ujjm().b[4][1]++,"border-error focus:border-error focus:ring-error")),"input input-bordered mb-0 w-full focus:outline-none focus:ring-1"),name:"imageUrl",value:form.values.imageUrl,"aria-required":"true",onChange:form.handleChange,onBlur:form.handleBlur,"aria-invalid":form.hasError.imageUrl,"aria-describedby":"imageUrlError"}),(0,jsx_runtime.jsxs)("div",{className:"mb-2 mt-0",children:[(0,jsx_runtime.jsx)("span",{id:"imageUrlError","aria-live":"assertive",className:"text-sm text-red-500",children:(cov_gsgi2ujjm().b[5][0]++,form.hasError.imageUrl&&(cov_gsgi2ujjm().b[5][1]++,form.errors.imageUrl))})," "]}),(0,jsx_runtime.jsx)("label",{htmlFor:"price",children:"Price"}),(0,jsx_runtime.jsx)("input",{type:"text",className:(0,clsx.Z)((cov_gsgi2ujjm().b[6][0]++,form.hasError.price&&(cov_gsgi2ujjm().b[6][1]++,"border-error focus:border-error focus:ring-error")),"input input-bordered mb-0 w-full focus:outline-none focus:ring-1"),name:"price",value:form.values.price,"aria-required":"true",onChange:form.handleChange,onBlur:form.handleBlur,"aria-invalid":form.hasError.price,"aria-describedby":"priceError"}),(0,jsx_runtime.jsxs)("div",{className:"mb-2 mt-0",children:[(0,jsx_runtime.jsx)("span",{id:"priceError","aria-live":"assertive",className:"text-sm text-red-500",children:(cov_gsgi2ujjm().b[7][0]++,form.hasError.price&&(cov_gsgi2ujjm().b[7][1]++,form.errors.price))})," "]}),(0,jsx_runtime.jsx)("button",{type:"submit",className:"btn btn-primary btn-block mt-4",children:"Add Product"})]})]})]})}cov_gsgi2ujjm().s[5]++,AddProductPage.__docgenInfo={description:"",methods:[],displayName:"AddProductPage"};var vi_nSCvwQ7l=__webpack_require__("./node_modules/vitest/dist/chunks/vi.nSCvwQ7l.js"),assert=__webpack_require__("./node_modules/assert/build/assert.js");const index_stories={parameters:{storySource:{source:'//Disabling the following rule because\n// we need to import \'expect\' from vitest\n// (that I beleive has more or less the same interafce as Jest)\n// as all expect matchers imported\n//from \'@storybook/test-runner\' as well as from\n// @sorybook/jest are async (return Promise).\n//Vitest also already part of Storybook whereas with jest\n//I would have had to install the jest package.\n import { faker } from "@faker-js/faker/locale/en";\nimport AddProductPage, { validationSchema } from "@/pages/add-product";\nimport { expect } from "vitest";\nimport { AssertionError } from "assert";\nconst meta = {\n    component: AddProductPage,\n    excludeStories: [\n        "ErrorCases"\n    ]\n};\nexport default meta;\n//FIRST INSTANCE of why reflecting on Yup schema is\n//so painful:\n//\n// The abomination below necessary to get `max` value\n//in a max constraint.\n//\n//validationSchema.describe()\n// .fields.name.tests.find((obj) => obj.name === \'max\').params.max + 1\nfaker.seed(123); //to keep generated data deterministic otherwise\n//story snapshots would get change with every run on Chromatic\n//NOTE: re. typescript assertion functions below,\n//they cannot be arrow functions or TS throws errors.\n//better than \'as SchemaDescription\' all over the place\nfunction assertFieldSchemaIsSchemaDescription(fieldSchema) {\n    if (fieldSchema.tests === undefined) {\n        throw new AssertionError({\n            message: "The provided Yup schema for a field was not of type SchemaDescription"\n        });\n    }\n}\nfunction assertTestParamsDefined(testParams) {\n    expect(testParams).toBeDefined();\n}\n//A bit unorthodox, but in these createXXXSchema functions\n//below, I am asserting that the Yup schema has not changed\n//from what was expected. If it has, we would update the\n//TestCaseGenerator as well as add test cases in the\n//Screen (pure presentational page component for this page)\n//SECOND INSTANCE of how difficult it is to reflect\n//  why I need to move away from Yup:\n//why should reflectin on error message supplied\n//at schema construction time be so painful?\nconst getValidationErrorMessage = (path, value)=>{\n    try {\n        validationSchema.validateSyncAt(path, value);\n        //as a fallback, if no ValidationError is thrown then\n        //we throw an AssertionError\n        throw new AssertionError({\n            message: `An error should have been thrown whan validating value "${value}" at path ${path} using the YUP schema`\n        });\n    } catch (ex) {\n        //we know for a fact that ex is ValidationError\n        const err = ex;\n        return err.message;\n    }\n};\nfunction getTest(fieldSchema, testName) {\n    const test = fieldSchema.tests.find((obj)=>obj.name === testName);\n    if (!test) {\n        throw new AssertionError({\n            message: `The test named ${testName} in YUP field schema does not exist.`\n        });\n    }\n    return {\n        name: testName,\n        params: test.params\n    };\n}\nconst createNameErrorCases = (fieldSchemas)=>{\n    const nameSchema = fieldSchemas.name;\n    assertFieldSchemaIsSchemaDescription(nameSchema);\n    expect(Object.keys(nameSchema.tests).length).toEqual(2);\n    const max = getTest(nameSchema, "max");\n    assertTestParamsDefined(max.params);\n    const invalidName = faker.string.alpha(max.params.max + 1);\n    return {\n        NameMaxLength: {\n            InvalidValue: invalidName,\n            ErrorMessage: getValidationErrorMessage("name", invalidName)\n        },\n        NameRequired: {\n            InvalidValue: "",\n            ErrorMessage: getValidationErrorMessage("name", "")\n        }\n    };\n};\n// const createDescriptionErrorCases = (fieldSchemas: Record<string, SchemaFieldDescription>) {\n//   const descSchema = fieldSchemas.\n// }\nconst createErrorCases = ()=>{\n    const fieldSchemas = validationSchema.describe().fields;\n    expect(fieldSchemas).toHaveLength(4);\n    return {\n        ...createNameErrorCases(fieldSchemas)\n    };\n};\nexport const ErrorCases = createErrorCases();\n',locationsMap:{"error-cases":{startLoc:{col:26,line:106},endLoc:{col:44,line:106},startBody:{col:26,line:106},endBody:{col:44,line:106}}}}},component:AddProductPage,excludeStories:["ErrorCases"]};chunk_LSEVNFON.a.seed(123);const getValidationErrorMessage=(path,value)=>{try{throw validationSchema.validateSyncAt(path,value),new assert.AssertionError({message:`An error should have been thrown whan validating value "${value}" at path ${path} using the YUP schema`})}catch(ex){return ex.message}};const createNameErrorCases=fieldSchemas=>{const nameSchema=fieldSchemas.name;!function assertFieldSchemaIsSchemaDescription(fieldSchema){if(void 0===fieldSchema.tests)throw new assert.AssertionError({message:"The provided Yup schema for a field was not of type SchemaDescription"})}(nameSchema),(0,vi_nSCvwQ7l.a)(Object.keys(nameSchema.tests).length).toEqual(2);const max=function getTest(fieldSchema,testName){const test=fieldSchema.tests.find((obj=>obj.name===testName));if(!test)throw new assert.AssertionError({message:`The test named ${testName} in YUP field schema does not exist.`});return{name:testName,params:test.params}}(nameSchema,"max");!function assertTestParamsDefined(testParams){(0,vi_nSCvwQ7l.a)(testParams).toBeDefined()}(max.params);const invalidName=chunk_LSEVNFON.a.string.alpha(max.params.max+1);return{NameMaxLength:{InvalidValue:invalidName,ErrorMessage:getValidationErrorMessage("name",invalidName)},NameRequired:{InvalidValue:"",ErrorMessage:getValidationErrorMessage("name","")}}},ErrorCases=(()=>{const fieldSchemas=validationSchema.describe().fields;return(0,vi_nSCvwQ7l.a)(fieldSchemas).toHaveLength(4),{...createNameErrorCases(fieldSchemas)}})(),__namedExportsOrder=["ErrorCases"]},"?cc9d":()=>{}}]);